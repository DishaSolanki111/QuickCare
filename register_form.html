<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Patient Registration</title>
<style>
  :root{
    --accent:#2e6ad6;
    --accent-dark:#1f56b3;
    --muted:#6b7280;
    --card:#ffffff;
    --bg:#f5f8ff;
  }
  body{
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    padding:20px;
  }

  .card{
    width:780px;
    max-width:100%;
    background:var(--card);
    border-radius:14px;
    box-shadow: 0 8px 30px rgba(20,30,60,0.08);
    padding:22px;
    box-sizing:border-box;
  }

  .card h1{
    margin:0 0 6px 0;
    font-size:20px;
    color:#0f1724;
  }
  .card p.lead{
    margin:0 0 18px 0;
    color:var(--muted);
    font-size:14px;
  }

  .grid {
    display: grid;
    gap:14px;
    grid-template-columns: repeat(2, 1fr);
  }

  .full { grid-column: 1 / -1; }

  label{
    display:block;
    font-size:13px;
    color:#334155;
    margin-bottom:6px;
  }

  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="tel"],
  input[type="date"],
  select,
  textarea {
    width:100%;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #e6e9ef;
    background:white;
    box-sizing:border-box;
    font-size:14px;
    color:#0f1724;
  }

  textarea { min-height:90px; resize:vertical; }

  .row {
    display:flex;
    gap:10px;
    align-items:center;
  }

  .radio-group { display:flex; gap:12px; align-items:center; }
  .radio-group label { margin-bottom:0; font-size:14px; color:#334155; }

  .actions {
    margin-top:18px;
    display:flex;
    gap:12px;
    align-items:center;
  }

  button.primary {
    border:0;
    background:var(--accent);
    color:white;
    padding:10px 16px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
  }
  button.primary:hover { background:var(--accent-dark); }

  button.ghost {
    background:transparent;
    border:1px solid #e6e9ef;
    padding:10px 14px;
    border-radius:10px;
    cursor:pointer;
  }

  .helper { color:var(--muted); font-size:13px; margin-top:8px; }

  .notice {
    padding:10px 12px;
    border-radius:8px;
    margin-top:12px;
    font-size:14px;
  }
  .notice.success { background:#ecfdf5; color:#065f46; border:1px solid #d1fae5; }
  .notice.error { background:#fff1f2; color:#b91c1c; border:1px solid #fecaca; }

  @media (max-width:760px){
    .grid{ grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<div class="card" role="form" aria-labelledby="regTitle">
  <h1 id="regTitle">New Patient Registration</h1>
  <p class="lead">Fill the details below to register. After registering you'll be able to book an appointment.</p>

  <form id="regForm" autocomplete="off">
    <div class="grid">

      <!-- P_ID (auto) -->
      <div class="full">
        <label>P_ID</label>
        <input type="text" name="P_ID" value="Auto-generated" readonly />
      </div>

      <div>
        <label>First name <span style="color:#B91C1C">*</span></label>
        <input type="text" name="FIRST_NAME" required />
      </div>

      <div>
        <label>Last name</label>
        <input type="text" name="LAST_NAME" />
      </div>

      <div>
        <label>Username <span style="color:#B91C1C">*</span></label>
        <input type="text" name="USERNAME" required />
      </div>

      <div>
        <label>Password <span style="color:#B91C1C">*</span></label>
        <input type="password" name="PSW" id="psw" required minlength="6" />
      </div>

      <div>
        <label>Date of Birth</label>
        <input type="date" name="DOB" />
      </div>

      <div>
        <label>Gender</label>
        <div class="radio-group" role="radiogroup" aria-label="Gender">
          <label><input type="radio" name="GENDER" value="M" /> Male</label>
          <label><input type="radio" name="GENDER" value="F" /> Female</label>
          <label><input type="radio" name="GENDER" value="O" /> Other</label>
        </div>
      </div>

      <div>
        <label>Blood Group</label>
        <select name="BLOOD_GROUP">
          <option value="">Select</option>
          <option>A+</option><option>A-</option>
          <option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option>
          <option>O+</option><option>O-</option>
        </select>
      </div>

      <div>
        <label>Diabetes</label>
        <select name="DIABETES">
          <option value="">Select</option>
          <option value="No">No</option>
          <option value="Type 1">Type 1</option>
          <option value="Type 2">Type 2</option>
        </select>
      </div>

      <div>
        <label>Phone <span style="color:#B91C1C">*</span></label>
        <input type="tel" name="PHONE" pattern="[0-9]{10}" placeholder="10 digit mobile" required />
      </div>

      <div>
        <label>Email</label>
        <input type="email" name="EMAIL" />
      </div>

      <div class="full">
        <label>Address</label>
        <textarea name="ADDRESS"></textarea>
      </div>

    </div> <!-- grid -->

    <div class="actions">
      <button type="submit" class="primary">Register & Continue</button>
      <button type="button" class="ghost" onclick="document.getElementById('regForm').reset()">Reset</button>
    </div>

    <div id="msg" aria-live="polite"></div>
    <p class="helper">Fields marked with <span style="color:#B91C1C">*</span> are required.</p>
  </form>
</div>

<script>
  const form = document.getElementById('regForm');
  const msg = document.getElementById('msg');

  function showMessage(type, text){
    msg.innerHTML = `<div class="notice ${type === 'success' ? 'success' : 'error'}">${text}</div>`;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    msg.innerHTML = '';

    // Basic client validation
    const data = new FormData(form);
    if (!data.get('FIRST_NAME') || !data.get('USERNAME') || !data.get('PSW') || !data.get('PHONE')) {
      showMessage('error', 'Please fill required fields: First name, Username, Password, Phone.');
      return;
    }
    if (!/^\d{10}$/.test(data.get('PHONE'))) {
      showMessage('error', 'Phone must be 10 digits.');
      return;
    }
    if (data.get('PSW').length < 6) {
      showMessage('error', 'Password must be at least 6 characters.');
      return;
    }

    // Convert to JSON for your register.php which expects JSON in previous examples
    const payload = {};
    data.forEach((v,k) => { payload[k] = v; });

    showMessage('success', 'Registering...');

    try {
      const res = await fetch('register.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
      const json = await res.json();

      if (json && json.success) {
        showMessage('success', 'Registration successful. Redirecting...');
        // default behaviour: reload so session becomes available, or call your next step
        setTimeout(() => {
          if (typeof onRegisterSuccess === 'function') {
            onRegisterSuccess(json); // optional callback
          } else {
            location.reload();
          }
        }, 900);
      } else {
        showMessage('error', json && json.error ? json.error : 'Registration failed.');
      }
    } catch (err) {
      console.error(err);
      showMessage('error', 'Network/server error. Check console.');
    }
  });
</script>

</body>
</html>
    